<!DOCTYPE html>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    

    <title>Linux firewalling — Personal Notes</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css">
    <link rel="stylesheet" type="text/css" href="_static/classic.css">
    <link rel="stylesheet" type="text/css" href="_static/custom.css">
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    
    <link rel="author" title="About these documents" href="about.html">
    <link rel="index" title="Index" href="genindex.html">
    <link rel="search" title="Search" href="search.html">
    <link rel="next" title="Installing a Debian unstable virtual machine" href="debian_unstable_vm.html">
    <link rel="prev" title="Debian applications installation" href="debian_apps_install.html"> 
  </head>
<body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index" accesskey="I">index</a>
</li>
        <li class="right">
          <a href="debian_unstable_vm.html" title="Installing a Debian unstable virtual machine" accesskey="N">next</a> |</li>
        <li class="right">
          <a href="debian_apps_install.html" title="Debian applications installation" accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0">
<a href="index.html">Personal Notes</a> »</li>
        <li class="nav-item nav-item-this"><a href="">Linux firewalling</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="linux-firewalling">
<h1>Linux firewalling<a class="headerlink" href="#linux-firewalling" title="Permalink to this heading">¶</a>
</h1>
<nav class="contents local" id="page-content">
<p class="topic-title">Page content</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id6">Introduction</a></p></li>
<li><p><a class="reference internal" href="#disabling-iptables" id="id7">Disabling iptables</a></p></li>
<li><p><a class="reference internal" href="#finding-the-open-ports-on-the-local-network" id="id8">Finding the open ports on the local network</a></p></li>
<li>
<p><a class="reference internal" href="#configuring-nftables" id="id9">Configuring nftables</a></p>
<ul>
<li><p><a class="reference internal" href="#nftables-configuration-file" id="id10">nftables configuration file</a></p></li>
<li><p><a class="reference internal" href="#nft-administration-tool" id="id11">nft administration tool</a></p></li>
<li><p><a class="reference internal" href="#example-nftables-configuration" id="id12">Example nftables configuration</a></p></li>
<li><p><a class="reference internal" href="#allow-outgoing-web-queries-to-a-set-of-specific-servers" id="id13">Allow outgoing Web queries to a set of specific servers</a></p></li>
<li><p><a class="reference internal" href="#deleting-individual-rules-or-sets" id="id14">Deleting individual rules or sets</a></p></li>
<li><p><a class="reference internal" href="#deleting-the-whole-ruleset" id="id15">Deleting the whole ruleset</a></p></li>
<li><p><a class="reference internal" href="#note-about-dhcp" id="id16">Note about DHCP</a></p></li>
<li><p><a class="reference internal" href="#updating-etc-nftables-conf" id="id17">Updating /etc/nftables.conf</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#installing-and-configuring-fail2ban" id="id18">Installing and configuring Fail2ban</a></p></li>
<li><p><a class="reference internal" href="#other-resources" id="id19">Other resources</a></p></li>
</ul>
</nav>
<section id="introduction">
<span id="index-0"></span><h2>
<a class="toc-backref" href="#id6" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a>
</h2>
<p id="index-1">This page is where I keep track of the few things I know about Linux
firewalling and port scanning with <a class="reference external" href="https://en.wikipedia.org/wiki/Nftables">nftables</a>, <a class="reference external" href="https://nmap.org">Nmap</a>, <a class="reference external" href="https://linuxhint.com/ss-command-linux">ss</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Fail2ban">Fail2ban</a>.</p>
<p>Use what you find on this page at your own risk. I’m not a network security
specialist so the firewall configuration provided on this page may not be the
best one. And your needs may be different than mine.</p>
</section>
<section id="disabling-iptables">
<h2>
<a class="toc-backref" href="#id7" role="doc-backlink">Disabling iptables</a><a class="headerlink" href="#disabling-iptables" title="Permalink to this heading">¶</a>
</h2>
<p id="index-2"><a class="reference external" href="https://en.wikipedia.org/wiki/Iptables">iptables</a> is the predecessor of
nftables, and used to be the default network filtering framework in <a class="reference external" href="https://www.debian.org">Debian
GNU/Linux</a>. <a class="reference external" href="https://www.debian.org/releases/buster/amd64/release-nojjtes/ch-whats-new.en.html#nftables">Starting with Debian 10 (Buster), the
default network filtering framework is nftables</a>.</p>
<p>if iptables is installed on your system, you can list the rules (<strong>as root</strong>)
with <code class="docutils literal notranslate"><span class="pre">iptables</span> <span class="pre">-L</span></code> (for the IPv4 protocol) and <code class="docutils literal notranslate"><span class="pre">ip6tables</span> <span class="pre">-L</span></code> (for the IPv6
protocol). Here is the output you get when iptables is not configured:</p>
<div class="line-block">
<div class="line">Chain INPUT (policy ACCEPT)</div>
<div class="line">target     prot opt source               destination</div>
<div class="line"><br></div>
<div class="line">Chain FORWARD (policy ACCEPT)</div>
<div class="line">target     prot opt source               destination</div>
<div class="line"><br></div>
<div class="line">Chain OUTPUT (policy ACCEPT)</div>
<div class="line">target     prot opt source               destination</div>
</div>
<p>Alternatively, you can use <code class="docutils literal notranslate"><span class="pre">iptables</span> <span class="pre">-S</span></code> and <code class="docutils literal notranslate"><span class="pre">ip6tables</span> <span class="pre">-S</span></code> (<strong>as root</strong>).
When iptables is not configured, you get:</p>
<div class="line-block">
<div class="line">-P INPUT ACCEPT</div>
<div class="line">-P FORWARD ACCEPT</div>
<div class="line">-P OUTPUT ACCEPT</div>
</div>
<p>You can flush the iptables rules (<strong>as root</strong>) with:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>iptables<span class="w"> </span>-F
ip6tables<span class="w"> </span>-F
</pre></div>
</div>
<p>You may also want to uninstall iptables. You can do so (<strong>as root</strong>) with:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>apt-get<span class="w"> </span>remove<span class="w"> </span>iptables
</pre></div>
</div>
</section>
<section id="finding-the-open-ports-on-the-local-network">
<h2>
<a class="toc-backref" href="#id8" role="doc-backlink">Finding the open ports on the local network</a><a class="headerlink" href="#finding-the-open-ports-on-the-local-network" title="Permalink to this heading">¶</a>
</h2>
<p id="index-3">I use <a class="reference external" href="https://nmap.org">Nmap</a> to scan for open ports on hosts of my local
network. On a <a class="reference external" href="https://www.debian.org">Debian GNU/Linux</a> system, you can
install it with:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>apt-get<span class="w"> </span>install<span class="w"> </span>nmap
</pre></div>
</div>
<p>by default, Nmap scans the 1000 most popular TCP ports (<code class="docutils literal notranslate"><span class="pre">-vv</span></code> is for incresed
verbosity):</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>nmap<span class="w"> </span>-vv<span class="w"> </span>host_name
</pre></div>
</div>
<div class="line-block">
<div class="line">Starting Nmap 7.80 ( <a class="reference external" href="https://nmap.org">https://nmap.org</a> ) at 2022-06-12 13:56 CEST</div>
<div class="line">Initiating Ping Scan at 13:56</div>
<div class="line">Scanning host_name (XXX.XXX.XXX.XXX) [4 ports]</div>
<div class="line">Completed Ping Scan at 13:56, 0.04s elapsed (1 total hosts)</div>
<div class="line">Initiating SYN Stealth Scan at 13:56</div>
<div class="line">Scanning host_name (XXX.XXX.XXX.XXX) [1000 ports]</div>
<div class="line">Discovered open port 3389/tcp on XXX.XXX.XXX.XXX</div>
<div class="line">Discovered open port 22/tcp on XXX.XXX.XXX.XXX</div>
<div class="line">Completed SYN Stealth Scan at 13:56, 1.38s elapsed (1000 total ports)</div>
<div class="line">Nmap scan report for host_name (XXX.XXX.XXX.XXX)</div>
<div class="line">Host is up, received echo-reply ttl 55 (0.019s latency).</div>
<div class="line">Scanned at 2022-06-12 13:56:11 CEST for 1s</div>
<div class="line">Not shown: 997 closed ports</div>
<div class="line">Reason: 997 resets</div>
<div class="line">PORT     STATE    SERVICE       REASON</div>
<div class="line">22/tcp   open     ssh           syn-ack ttl 55</div>
<div class="line">25/tcp   filtered smtp          no-response</div>
<div class="line">3389/tcp open     ms-wbt-server syn-ack ttl 55</div>
<div class="line">MAC Address: XX:XX:XX:XX:XX:XX</div>
<div class="line"><br></div>
<div class="line">Read data files from: /usr/bin/../share/nmap</div>
<div class="line">Nmap done: 1 IP address (1 host up) scanned in 1.53 seconds</div>
<div class="line-block">
<div class="line">Raw packets sent: 1005 (44.196KB) | Rcvd: 1000 (39.996KB)</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">-F</span></code> option is for a fast scan (only the most popular ports are scanned):</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>nmap<span class="w"> </span>-vv<span class="w"> </span>-F<span class="w"> </span>host_name
</pre></div>
</div>
<div class="line-block">
<div class="line">Starting Nmap 7.80 ( <a class="reference external" href="https://nmap.org">https://nmap.org</a> ) at 2022-06-06 07:32 CEST</div>
<div class="line">Initiating ARP Ping Scan at 13:57</div>
<div class="line">Scanning host_name (XXX.XXX.XXX.XXX) [1 port]</div>
<div class="line">Completed ARP Ping Scan at 13:57, 0.11s elapsed (1 total hosts)</div>
<div class="line">Initiating SYN Stealth Scan at 13:57</div>
<div class="line">Scanning host_name (XXX.XXX.XXX.XXX) [100 ports]</div>
<div class="line">Discovered open port 22/tcp on XXX.XXX.XXX.XXX</div>
<div class="line">Completed SYN Stealth Scan at 13:57, 2.42s elapsed (100 total ports)</div>
<div class="line">Nmap scan report for host_name (XXX.XXX.XXX.XXX)</div>
<div class="line">Host is up, received arp-response (0.054s latency).</div>
<div class="line">rDNS record for XXX.XXX.XXX.XXX: host_name.localdomain</div>
<div class="line">Scanned at 2022-06-12 13:57:31 CEST for 2s</div>
<div class="line">Not shown: 97 closed ports</div>
<div class="line">Reason: 97 resets</div>
<div class="line">PORT     STATE    SERVICE       REASON</div>
<div class="line">22/tcp   open     ssh           syn-ack ttl 64</div>
<div class="line">25/tcp   filtered smtp          no-response</div>
<div class="line">3389/tcp open     ms-wbt-server syn-ack ttl 55</div>
<div class="line">MAC Address: XX:XX:XX:XX:XX:XX</div>
<div class="line"><br></div>
<div class="line">Read data files from: /usr/bin/../share/nmap</div>
<div class="line">Nmap done: 1 IP address (1 host up) scanned in 0.22 seconds</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">-p</span></code> option is to specify a single port (or a port range, e.g. <code class="docutils literal notranslate"><span class="pre">p22-25</span></code>):</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>nmap<span class="w"> </span>-p3142<span class="w"> </span>host_name
</pre></div>
</div>
<div class="line-block">
<div class="line">Starting Nmap 7.80 ( <a class="reference external" href="https://nmap.org">https://nmap.org</a> ) at 2022-06-06 07:33 CEST</div>
<div class="line">Nmap scan report for host_name (XXX.XXX.XXX.XXX)</div>
<div class="line">Host is up (0.0015s latency).</div>
<div class="line">rDNS record for XXX.XXX.XXX.XXX: host_name.localdomain</div>
<div class="line"><br></div>
<div class="line">PORT     STATE SERVICE</div>
<div class="line">3142/tcp open  apt-cacher</div>
<div class="line">MAC Address: XX:XX:XX:XX:XX:XX</div>
<div class="line"><br></div>
<div class="line">Nmap done: 1 IP address (1 host up) scanned in 0.20 seconds</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">-sU</span></code> is for a UDP scan, <code class="docutils literal notranslate"><span class="pre">--top-ports</span></code> is to scan only the most common
ports (here the 100 most common ports). Note that <strong>UDP scan requires root
privileges</strong>:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>nmap<span class="w"> </span>-vv<span class="w"> </span>-sU<span class="w"> </span>-top-ports<span class="w"> </span><span class="m">100</span><span class="w"> </span>host_name
</pre></div>
</div>
<div class="line-block">
<div class="line">Starting Nmap 7.80 ( <a class="reference external" href="https://nmap.org">https://nmap.org</a> ) at 2022-06-12 13:58 CEST</div>
<div class="line">Initiating ARP Ping Scan at 13:58</div>
<div class="line">Scanning host_name (XXX.XXX.XXX.XXX) [1 port]</div>
<div class="line">Completed ARP Ping Scan at 13:58, 0.13s elapsed (1 total hosts)</div>
<div class="line">Initiating UDP Scan at 13:58</div>
<div class="line">Scanning host_name (XXX.XXX.XXX.XXX) [100 ports]</div>
<div class="line">Increasing send delay for XXX.XXX.XXX.XXX from 0 to 50 due to max_successful_tryno increase to 4</div>
<div class="line">Increasing send delay for XXX.XXX.XXX.XXX from 50 to 100 due to max_successful_tryno increase to 5</div>
<div class="line">Increasing send delay for XXX.XXX.XXX.XXX from 100 to 200 due to max_successful_tryno increase to 6</div>
<div class="line">Increasing send delay for XXX.XXX.XXX.XXX from 200 to 400 due to max_successful_tryno increase to 7</div>
<div class="line">Increasing send delay for XXX.XXX.XXX.XXX from 400 to 800 due to max_successful_tryno increase to 8</div>
<div class="line">Discovered open port 5353/udp on XXX.XXX.XXX.XXX</div>
<div class="line">UDP Scan Timing: About 41.20% done; ETC: 13:59 (0:00:44 remaining)</div>
<div class="line">Completed UDP Scan at 14:00, 104.42s elapsed (100 total ports)</div>
<div class="line">Nmap scan report for host_name (XXX.XXX.XXX.XXX)</div>
<div class="line">Host is up, received arp-response (0.13s latency).</div>
<div class="line">rDNS record for XXX.XXX.XXX.XXX: host_name.localdomain</div>
<div class="line">Scanned at 2022-06-12 13:58:35 CEST for 105s</div>
<div class="line">Not shown: 98 closed ports</div>
<div class="line">Reason: 98 port-unreaches</div>
<div class="line">PORT     STATE         SERVICE  REASON</div>
<div class="line">68/udp   open|filtered dhcpc    no-response</div>
<div class="line">5353/udp open          zeroconf udp-response ttl 255</div>
<div class="line">MAC Address: XX:XX:XX:XX:XX:XX</div>
<div class="line"><br></div>
<div class="line">Read data files from: /usr/bin/../share/nmap</div>
<div class="line">Nmap done: 1 IP address (1 host up) scanned in 104.64 seconds</div>
<div class="line-block">
<div class="line">Raw packets sent: 201 (7.040KB) | Rcvd: 111 (6.956KB)</div>
</div>
</div>
<p>Using the command <code class="docutils literal notranslate"><span class="pre">ss</span></code>, you can see which process or service uses a specific
port. On a <a class="reference external" href="https://www.debian.org">Debian GNU/Linux</a> system, you can
install it with:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>apt-get<span class="w"> </span>install<span class="w"> </span>iproute2
</pre></div>
</div>
<p>For example, to see which services uses the ports that Nmap has found opened,
you can do something like:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>ss<span class="w"> </span>-ane<span class="p">|</span>awk<span class="w"> </span><span class="s2">"NR == 1 || /[0-9\]]:(22 |68 |3142 |5353 )/"</span>
</pre></div>
</div>
<p>The output obtained on my Debian machines <a class="reference download internal" download="" href="_downloads/4bb5b08b0a8a4719a64cf18849d4d695/ss_22_68_3142_5353"><code class="xref download docutils literal notranslate"><span class="pre">is</span> <span class="pre">available</span> <span class="pre">for</span> <span class="pre">download</span>
<span class="pre">(file</span> <span class="pre">ss_22_68_3142_5353)</span></code></a>.</p>
</section>
<section id="configuring-nftables">
<h2>
<a class="toc-backref" href="#id9" role="doc-backlink">Configuring nftables</a><a class="headerlink" href="#configuring-nftables" title="Permalink to this heading">¶</a>
</h2>
<section id="nftables-configuration-file">
<h3>
<a class="toc-backref" href="#id10" role="doc-backlink">nftables configuration file</a><a class="headerlink" href="#nftables-configuration-file" title="Permalink to this heading">¶</a>
</h3>
<p id="index-4">The configuration file for nftables is the <code class="docutils literal notranslate"><span class="pre">/etc/nftables.conf</span></code> script. It’s
not run if the nftables service is not active. You can check the nftables
service status with:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>systemctl<span class="w"> </span>status<span class="w"> </span>nftables
</pre></div>
</div>
<p>You can start and stop the service <strong>as root</strong> with:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>systemctl<span class="w"> </span>start<span class="w"> </span>nftables
systemctl<span class="w"> </span>stop<span class="w"> </span>nftables
</pre></div>
</div>
<p>The service is started automatically when the machine boots only if it is
“enabled”. You can enable the service <strong>as root</strong> with:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>nftables
</pre></div>
</div>
<p>or:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>nftables<span class="w"> </span>--now<span class="w"> </span><span class="c1"># Start and enable the service.</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">/etc/nftables.conf</span></code> has changed, you can take the change into account
<strong>as root</strong> with:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>systemctl<span class="w"> </span>reload<span class="w"> </span>nftables
</pre></div>
</div>
<p>You can disable the service <strong>as root</strong> with:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>systemctl<span class="w"> </span>disable<span class="w"> </span>nftables
systemctl<span class="w"> </span>disable<span class="w"> </span>nftables<span class="w"> </span>--now<span class="w"> </span><span class="c1"># Stop and disable the service.</span>
</pre></div>
</div>
</section>
<section id="nft-administration-tool">
<h3>
<a class="toc-backref" href="#id11" role="doc-backlink">nft administration tool</a><a class="headerlink" href="#nft-administration-tool" title="Permalink to this heading">¶</a>
</h3>
<p id="index-5"><code class="docutils literal notranslate"><span class="pre">nft</span></code> is the command line administration tool of the nftables framework that
make it possible to add, delete or change packet filtering rules with immediate
effect.</p>
<p>One way of managing nftables configuration is to configure it using <code class="docutils literal notranslate"><span class="pre">nft</span></code> and
then to use <code class="docutils literal notranslate"><span class="pre">nft</span></code> to output the rules (using command <code class="docutils literal notranslate"><span class="pre">nft</span> <span class="pre">list</span> <span class="pre">ruleset</span></code>).
The output can be used as content for the <code class="docutils literal notranslate"><span class="pre">/etc/nftables.conf</span></code> script. Just
make sure to prepend the shebang and a flush command:</p>
<div class="line-block">
<div class="line">#!/usr/sbin/nft -f</div>
<div class="line">flush ruleset</div>
</div>
<p>Note also that you can check the validity of the commands in the script
(without actually running them) with the <code class="docutils literal notranslate"><span class="pre">--check</span></code> option:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>nft<span class="w"> </span>--check<span class="w"> </span>--file<span class="w"> </span>/etc/nftables.conf
</pre></div>
</div>
</section>
<section id="example-nftables-configuration">
<h3>
<a class="toc-backref" href="#id12" role="doc-backlink">Example nftables configuration</a><a class="headerlink" href="#example-nftables-configuration" title="Permalink to this heading">¶</a>
</h3>
<p id="index-6">Once again, use what you find here at your own risk!</p>
<p>All the <code class="docutils literal notranslate"><span class="pre">nft</span></code> commands below have to be run <strong>as root</strong>:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span><span class="c1"># Remove all rules.</span>
nft<span class="w"> </span>flush<span class="w"> </span>ruleset

<span class="c1"># Add a table named "firewall" for IPv4 and IPv6.</span>
nft<span class="w"> </span>add<span class="w"> </span>table<span class="w"> </span>inet<span class="w"> </span>firewall

<span class="c1"># Add a chain named "fw_in" in table "firewall" with default policy "drop".</span>
<span class="c1"># The chain is attached to the input hook.</span>
nft<span class="w"> </span>add<span class="w"> </span>chain<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_in<span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="nb">type</span><span class="w"> </span>filter<span class="w"> </span>hook<span class="w"> </span>input<span class="w"> </span>priority<span class="w"> </span><span class="m">0</span><span class="se">\;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>policy<span class="w"> </span>drop<span class="se">\;</span><span class="w"> </span><span class="se">\</span>
<span class="o">}</span>

<span class="c1"># Similarly, add chains attached to the forward and output hooks.</span>
nft<span class="w"> </span>add<span class="w"> </span>chain<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_fwd<span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="nb">type</span><span class="w"> </span>filter<span class="w"> </span>hook<span class="w"> </span>forward<span class="w"> </span>priority<span class="w"> </span><span class="m">0</span><span class="se">\;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>policy<span class="w"> </span>drop<span class="se">\;</span><span class="w"> </span><span class="se">\</span>
<span class="o">}</span>
nft<span class="w"> </span>add<span class="w"> </span>chain<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="nb">type</span><span class="w"> </span>filter<span class="w"> </span>hook<span class="w"> </span>output<span class="w"> </span>priority<span class="w"> </span><span class="m">0</span><span class="se">\;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>policy<span class="w"> </span>drop<span class="se">\;</span><span class="w"> </span><span class="se">\</span>
<span class="o">}</span>

<span class="c1"># Drop invalid state connections.</span>
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_in<span class="w"> </span>ct<span class="w"> </span>state<span class="w"> </span>invalid<span class="w"> </span>drop

<span class="c1"># Allow all incoming / outgoing established and related traffic.</span>
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_in<span class="w"> </span>ct<span class="w"> </span>state<span class="w"> </span>established,<span class="w"> </span>related<span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span>ct<span class="w"> </span>state<span class="w"> </span>established,<span class="w"> </span>related<span class="w"> </span>accept

<span class="c1"># Allow everything from and to loopback interface.</span>
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_in<span class="w"> </span>iif<span class="w"> </span>lo<span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span>oif<span class="w"> </span>lo<span class="w"> </span>accept

<span class="c1"># Allow some inbound and outbound ICMP types.</span>
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_in<span class="w"> </span>icmp<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="o">{</span>destination-unreachable,<span class="w"> </span><span class="se">\</span>
<span class="w">                                            </span>echo-reply,<span class="w"> </span><span class="se">\</span>
<span class="w">                                            </span>echo-request,<span class="w"> </span><span class="se">\</span>
<span class="w">                                            </span>source-quench,<span class="w"> </span><span class="se">\</span>
<span class="w">                                            </span>time-exceeded<span class="o">}</span><span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_in<span class="w"> </span>icmpv6<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="o">{</span>destination-unreachable,<span class="w"> </span><span class="se">\</span>
<span class="w">                                              </span>echo-reply,<span class="w"> </span><span class="se">\</span>
<span class="w">                                              </span>echo-request,<span class="w"> </span><span class="se">\</span>
<span class="w">                                              </span>nd-neighbor-solicit,<span class="w"> </span><span class="se">\</span>
<span class="w">                                              </span>nd-router-advert,<span class="w"> </span><span class="se">\</span>
<span class="w">                                              </span>nd-neighbor-advert,<span class="w"> </span><span class="se">\</span>
<span class="w">                                              </span>packet-too-big,<span class="w"> </span><span class="se">\</span>
<span class="w">                                              </span>parameter-problem,<span class="w"> </span><span class="se">\</span>
<span class="w">                                              </span>time-exceeded<span class="w"> </span><span class="o">}</span><span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span>icmp<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="o">{</span>destination-unreachable,<span class="w"> </span><span class="se">\</span>
<span class="w">                                             </span>echo-reply,<span class="w"> </span><span class="se">\</span>
<span class="w">                                             </span>echo-request,<span class="w"> </span><span class="se">\</span>
<span class="w">                                             </span>source-quench,<span class="w"> </span><span class="se">\</span>
<span class="w">                                             </span>time-exceeded<span class="o">}</span><span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span>icmpv6<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="o">{</span>destination-unreachable,<span class="w"> </span><span class="se">\</span>
<span class="w">                                               </span>echo-reply,<span class="w"> </span><span class="se">\</span>
<span class="w">                                               </span>echo-request,<span class="w"> </span><span class="se">\</span>
<span class="w">                                               </span>nd-neighbor-solicit,<span class="w"> </span><span class="se">\</span>
<span class="w">                                               </span>nd-router-advert,<span class="w"> </span><span class="se">\</span>
<span class="w">                                               </span>nd-neighbor-advert,<span class="w"> </span><span class="se">\</span>
<span class="w">                                               </span>packet-too-big,<span class="w"> </span><span class="se">\</span>
<span class="w">                                               </span>parameter-problem,<span class="w"> </span><span class="se">\</span>
<span class="w">                                               </span>time-exceeded<span class="w"> </span><span class="o">}</span><span class="w"> </span>accept

<span class="c1"># Allow incoming SSH connections.</span>
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_in<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span>ssh<span class="w"> </span>accept

<span class="c1"># Allow outgoing DNS queries.</span>
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="m">53</span><span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span>udp<span class="w"> </span>dport<span class="w"> </span><span class="m">53</span><span class="w"> </span>accept

<span class="c1"># Allow outgoing NTP (Network Time Protocol) client requests.</span>
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span>udp<span class="w"> </span>dport<span class="w"> </span><span class="m">123</span><span class="w"> </span>accept

<span class="c1"># NOTE: If you just need SSH access to the machine and time synchronization,</span>
<span class="c1"># you can stop here.</span>

<span class="c1"># Allow outgoing SSH connections.</span>
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span>ssh<span class="w"> </span>accept

<span class="c1"># Allow RDP.</span>
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_in<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="m">3389</span><span class="w"> </span>accept

<span class="c1"># Allow outgoing Web (http and https) queries.</span>
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span>http<span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span>https<span class="w"> </span>accept

<span class="c1"># Allow POP3-SSL client.</span>
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="m">995</span><span class="w"> </span>accept

<span class="c1"># Allow mDNS.</span>
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_in<span class="w"> </span>pkttype<span class="w"> </span>multicast<span class="w"> </span>udp<span class="w"> </span>dport<span class="w"> </span><span class="m">5353</span><span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span>udp<span class="w"> </span>sport<span class="w"> </span><span class="m">5353</span><span class="w"> </span>accept
</pre></div>
</div>
</section>
<section id="allow-outgoing-web-queries-to-a-set-of-specific-servers">
<h3>
<a class="toc-backref" href="#id13" role="doc-backlink">Allow outgoing Web queries to a set of specific servers</a><a class="headerlink" href="#allow-outgoing-web-queries-to-a-set-of-specific-servers" title="Permalink to this heading">¶</a>
</h3>
<p>On a remote machine, I initially used the configuration above (stopping after
allowing incoming SSH connections), and then realized I couldn’t upgrade the
system anymore (i.e. <code class="docutils literal notranslate"><span class="pre">apt-get</span> <span class="pre">update</span></code> and of course <code class="docutils literal notranslate"><span class="pre">apt-get</span> <span class="pre">dist-upgrade</span></code>
didn’t work any more) because nftables was blocking the DNS queries, and also
the Web queries to the Debian repositories.</p>
<p>Obviously, I allowed the outgoing DNS queries with the commands provided above,
defined a set of addresses for the servers used by the <code class="docutils literal notranslate"><span class="pre">apt-get</span> <span class="pre">update</span></code> and
<code class="docutils literal notranslate"><span class="pre">apt-get</span> <span class="pre">dist-upgrade</span></code> commands, and allowed outgoing Web (http and https)
queries.</p>
<p>Note that the list of servers used depends on your APT configuration.</p>
<p>I used the following commands (<strong>as root</strong>) to create and populate the set of
addresses:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span><span class="c1"># Create a set named "debian_sources" (in table "firewall") that can store</span>
<span class="c1"># multiple individual IPv4 addresses.</span>
nft<span class="w"> </span>add<span class="w"> </span><span class="nb">set</span><span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>debian_sources<span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">type</span><span class="w"> </span>ipv4_addr<span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="o">}</span>

<span class="c1"># Add some addresses to the set. Both numerical addresses and domain names</span>
<span class="c1"># are valid.</span>
nft<span class="w"> </span>add<span class="w"> </span>element<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>debian_sources<span class="w"> </span><span class="o">{</span><span class="w"> </span>XXX.XXX.XXX.XXX,<span class="w"> </span><span class="se">\</span>
<span class="w">                                               </span>YYY.YYY.YYY.YYY,<span class="w"> </span><span class="se">\</span>
<span class="w">                                               </span>ZZZ.ZZZ.ZZZ.ZZZ<span class="w"> </span><span class="o">}</span>
</pre></div>
</div>
<p>Finally I used the following commands (<strong>as root</strong>) to allow the Web queries
(http and https) to the servers in the set:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>ip<span class="w"> </span>daddr<span class="w"> </span>@debian_sources<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span>http<span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>ip<span class="w"> </span>daddr<span class="w"> </span>@debian_sources<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span>https<span class="w"> </span>accept
</pre></div>
</div>
</section>
<section id="deleting-individual-rules-or-sets">
<h3>
<a class="toc-backref" href="#id14" role="doc-backlink">Deleting individual rules or sets</a><a class="headerlink" href="#deleting-individual-rules-or-sets" title="Permalink to this heading">¶</a>
</h3>
<p>To delete an nftables rule, you first have to find its handle (a numerical
value). To see the handles of the rules, use option <code class="docutils literal notranslate"><span class="pre">-a</span></code> in the <code class="docutils literal notranslate"><span class="pre">nft</span> <span class="pre">list</span>
<span class="pre">ruleset</span></code> command:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>nft<span class="w"> </span>-a<span class="w"> </span>list<span class="w"> </span>ruleset
</pre></div>
</div>
<p>Then delete the rule with a command like the following (example of deletion of
a rule in the “fw_out” chain of the “firewall” table):</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>nft<span class="w"> </span>delete<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>fw_out<span class="w"> </span>handle<span class="w"> </span>&lt;handle_value&gt;
</pre></div>
</div>
<p>To delete a set, use a command like (example of deletion of a set in the table
“firewall”):</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>nft<span class="w"> </span>delete<span class="w"> </span><span class="nb">set</span><span class="w"> </span>inet<span class="w"> </span>firewall<span class="w"> </span>&lt;set_name&gt;
</pre></div>
</div>
</section>
<section id="deleting-the-whole-ruleset">
<h3>
<a class="toc-backref" href="#id15" role="doc-backlink">Deleting the whole ruleset</a><a class="headerlink" href="#deleting-the-whole-ruleset" title="Permalink to this heading">¶</a>
</h3>
<p>To delete the whole nftables ruleset, do:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>nft<span class="w"> </span>flush<span class="w"> </span>ruleset
</pre></div>
</div>
</section>
<section id="note-about-dhcp">
<h3>
<a class="toc-backref" href="#id16" role="doc-backlink">Note about DHCP</a><a class="headerlink" href="#note-about-dhcp" title="Permalink to this heading">¶</a>
</h3>
<p id="index-7">If you have to configure nftables on a machine that is also a <a class="reference external" href="https://en.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol">DHCP</a> server or
client, read the “Firewall rules” section in <a class="reference external" href="https://github.com/isc-projects/dhcp">the DHCP README file</a>.</p>
</section>
<section id="updating-etc-nftables-conf">
<h3>
<a class="toc-backref" href="#id17" role="doc-backlink">Updating /etc/nftables.conf</a><a class="headerlink" href="#updating-etc-nftables-conf" title="Permalink to this heading">¶</a>
</h3>
<p id="index-8">Once you have configured nftables using <code class="docutils literal notranslate"><span class="pre">nft</span></code> commands, you may want to
update <code class="docutils literal notranslate"><span class="pre">/etc/nftables.conf</span></code> so that the configuration is preserved on next
start of nftables. You can do this using the following commands (<strong>as root</strong>):</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span><span class="nb">printf</span><span class="w"> </span><span class="s1">'#!/usr/sbin/nft -f\n\nflush ruleset\n\n'</span><span class="w"> </span>&gt;<span class="w"> </span>/etc/nftables.conf
nft<span class="w"> </span>list<span class="w"> </span>ruleset<span class="w"> </span>&gt;&gt;<span class="w"> </span>/etc/nftables.conf
</pre></div>
</div>
</section>
</section>
<section id="installing-and-configuring-fail2ban">
<h2>
<a class="toc-backref" href="#id18" role="doc-backlink">Installing and configuring Fail2ban</a><a class="headerlink" href="#installing-and-configuring-fail2ban" title="Permalink to this heading">¶</a>
</h2>
<p id="index-9">You can install <a class="reference external" href="https://en.wikipedia.org/wiki/Fail2ban">Fail2ban</a> on a
<a class="reference external" href="https://www.debian.org">Debian GNU/Linux</a> system with:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>apt-get<span class="w"> </span>install<span class="w"> </span>fail2ban
</pre></div>
</div>
<p>Assuming you have nftables running, and an SSH server listening on port 22,
creating (<strong>as root</strong>) file <code class="docutils literal notranslate"><span class="pre">/etc/fail2ban/jail.local</span></code> with the following
content and then starting Fail2ban (<code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">start</span> <span class="pre">fail2ban</span></code>) should be
enough to have Fail2ban prevent brute force attacks on the SSH server.</p>
<div class="line-block">
<div class="line">[DEFAULT]</div>
<div class="line">banaction = nftables</div>
<div class="line">banaction_allports = nftables[type=allports]</div>
<div class="line"><br></div>
<div class="line">[sshd]</div>
<div class="line">enabled = true</div>
<div class="line">port = ssh</div>
</div>
<p>Make sure you enable Fail2ban so that it starts automatically on next reboot:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>fail2ban
</pre></div>
</div>
<p>You can get some information about the state of Fail2ban using
<code class="docutils literal notranslate"><span class="pre">fail2ban-client</span></code>:</p>
<div class="highlight-shell notranslate">
<div class="highlight"><pre><span></span>fail2ban-client<span class="w"> </span>status
fail2ban-client<span class="w"> </span>status<span class="w"> </span>sshd
</pre></div>
</div>
</section>
<section id="other-resources">
<h2>
<a class="toc-backref" href="#id19" role="doc-backlink">Other resources</a><a class="headerlink" href="#other-resources" title="Permalink to this heading">¶</a>
</h2>
<ul class="simple">
<li><p><a class="reference external" href="https://paulgorman.org/technical/linux-nftables.txt.html">Paul Gorman’s technical note about nftables</a></p></li>
<li><p><a class="reference external" href="https://xdeb.org/post/2019/setting-up-a-server-firewall-with-nftables-that-support-wireguard-vpn">Fredrik Jonsson’s blog post “Setting up a server firewall with nftables that
support WireGuard VPN”</a></p></li>
<li><p><a class="reference external" href="https://linux-audit.com/nftables-beginners-guide-to-traffic-filtering">Beginners guide to nftables traffic filtering</a></p></li>
<li><p><a class="reference external" href="https://www.stationx.net/nmap-cheat-sheet">Nmap cheat sheet</a></p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li>
<a class="reference internal" href="#">Linux firewalling</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#disabling-iptables">Disabling iptables</a></li>
<li><a class="reference internal" href="#finding-the-open-ports-on-the-local-network">Finding the open ports on the local network</a></li>
<li>
<a class="reference internal" href="#configuring-nftables">Configuring nftables</a><ul>
<li><a class="reference internal" href="#nftables-configuration-file">nftables configuration file</a></li>
<li><a class="reference internal" href="#nft-administration-tool">nft administration tool</a></li>
<li><a class="reference internal" href="#example-nftables-configuration">Example nftables configuration</a></li>
<li><a class="reference internal" href="#allow-outgoing-web-queries-to-a-set-of-specific-servers">Allow outgoing Web queries to a set of specific servers</a></li>
<li><a class="reference internal" href="#deleting-individual-rules-or-sets">Deleting individual rules or sets</a></li>
<li><a class="reference internal" href="#deleting-the-whole-ruleset">Deleting the whole ruleset</a></li>
<li><a class="reference internal" href="#note-about-dhcp">Note about DHCP</a></li>
<li><a class="reference internal" href="#updating-etc-nftables-conf">Updating /etc/nftables.conf</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installing-and-configuring-fail2ban">Installing and configuring Fail2ban</a></li>
<li><a class="reference internal" href="#other-resources">Other resources</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="debian_apps_install.html" title="previous chapter">Debian applications installation</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="debian_unstable_vm.html" title="next chapter">Installing a Debian unstable virtual machine</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
      <input type="submit" value="Go">
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index">index</a>
</li>
        <li class="right">
          <a href="debian_unstable_vm.html" title="Installing a Debian unstable virtual machine">next</a> |</li>
        <li class="right">
          <a href="debian_apps_install.html" title="Debian applications installation">previous</a> |</li>
        <li class="nav-item nav-item-0">
<a href="index.html">Personal Notes</a> »</li>
        <li class="nav-item nav-item-this"><a href="">Linux firewalling</a></li> 
      </ul>
    </div>
  <div class="footer" role="contentinfo">
        © Copyright 2018-2022, <a class="reference internal" href="about.html"><span class="doc">Thierry Rascle</span></a>.<br>
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png"></a>
    Work licensed under a
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.<br>
      <div class="generator_mention">Static website built using <a href="http://sphinx-doc.org/">Sphinx</a> and <a href="https://nokogiri.org/">Nokogiri</a>. Validated <a href="https://validator.w3.org/check?uri=referer">HTML5</a> / <a href="https://jigsaw.w3.org/css-validator/check/referer">CSS3</a>.</div>
    <a href="mailto:thierr26@free.fr">Feedback welcome</a>.
  </div>

  </body>
</html>
